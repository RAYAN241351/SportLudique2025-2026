{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"Bienvenue sur la documentation de Sport Ludique Bourges  Ann\u00e9e scolaire 2025-2026","text":""},{"location":"#contexte","title":"Contexte","text":"<p>Dans le cadre de notre formation dans le BTS SIO en SISR (Solution d'Infrastructure et Syst\u00e8mes et R\u00e9seaux), Nous avons comme tache de cr\u00e9er une infrastructure r\u00e9seau compl\u00e8te, ce projet est essentiel car il figure dans la notation de notre \u00e9preuve finale.</p> <p>Cette documentation repertorie toutes les modifications, les choix entrepris, ainsi que toutes les contraintes rencontr\u00e9es et les solutions de celles-ci</p>"},{"location":"#nous-sommes-en-groupe-de-2-personnes","title":"Nous sommes en groupe de 2 personnes:","text":"<ul> <li>Amine Khemiri</li> <li>Rayan Rouis</li> </ul>"},{"location":"#notre-topologie-reseau","title":"Notre topologie R\u00e9seau","text":""},{"location":"#logique","title":"logique","text":""},{"location":"#physique","title":"physique","text":""},{"location":"Adressage/","title":"Addressage","text":"<p>-172.28.0-31.0/19 Blois  -172.28.32-63.0/19 Chartres  -172.28.64-95.0/19 Tours  -172.28.96-127/19 Orl\u00e9ans  -172.28.128-159.0/19 Bourges   -172.16.90.200 : 9440 nutamix </p>"},{"location":"GRAYLOG/","title":"GRAYLOG","text":""},{"location":"GRAYLOG/#installation-et-configuration-de-graylog-sur-debian-graylog-7","title":"Installation et Configuration de Graylog sur Debian (graylog 7)","text":"<p>Cette documentation d\u00e9crit les \u00e9tapes pour installer et configurer Graylog sur un serveur Debian, en incluant la configuration de l'utilisateur admin et la s\u00e9curisation des mots de passe.</p>"},{"location":"GRAYLOG/#1-pre-requis","title":"1. Pr\u00e9-requis","text":"<p>Un serveur Debian \u00e0 jour</p> <p>Acc\u00e8s root ou sudo</p> <p>Serveur accessible sur le r\u00e9seau</p> <p>Ports \u00e0 ouvrir : 9000 (web interface Graylog)</p> <p>Mettre \u00e0 jour le serveur :</p> <p>```Installer les d\u00e9pendances :</p> <p>sudo apt install apt-transport-https openjdk-17-jdk pwgen curl gnupg -y java -version sudo apt update &amp;&amp; sudo apt upgrade -y</p> <pre><code>\n## 2. Installation des composants Graylog\n\nGraylog n\u00e9cessite MongoDB et Elasticsearch/OpenSearch. Pour cette installation locale, Graylog fonctionne avec une instance OpenSearch ou Elasticsearch. Cependant nous installerons opensearch sur un **serveur d\u00e9di\u00e9**\n\nGraylog n\u00e9cessite **MongoDB** et **OpenJDK** pour fonctionner.\n\n### Installer Java\n</code></pre> <p>sudo apt update sudo apt install openjdk-17-jdk -y java -version</p> <pre><code>\n### Installer MongoDB\n</code></pre> <p>sudo apt install mongodb -y sudo systemctl enable mongodb sudo systemctl start mongodb</p> <pre><code>## 3.Installation de Graylog\n\n### Ajouter le d\u00e9p\u00f4t Graylog\n\n</code></pre> <p>wget https://packages.graylog2.org/repo/packages/graylog-7.0-repository_latest.deb sudo dpkg -i graylog-7.0-repository_latest.deb sudo apt-get update</p> <pre><code>\n### Installer Graylog\n</code></pre> <p>sudo apt install graylog-server -y</p> <pre><code>## 4.Configuration de Graylog\n\nLe fichier principal est /etc/graylog/server/server.conf\n\n### D\u00e9finir le mot de passe secret\n\nLe mot de passe secret est utilis\u00e9 pour s\u00e9curiser les mots de passe stock\u00e9s.\n\n</code></pre> <p>pwgen -N 1 -s 96</p> <pre><code>\n### Copier la valeur g\u00e9n\u00e9r\u00e9e dans :\n\n</code></pre> <p>password_secret =  <pre><code>### D\u00e9finir le mot de passe root en faisant un hash\n\n</code></pre> <p>echo -n \"votre_mdp\" | sha256sum</p> <pre><code>\n### Copier le hash dans le fichier de conf:\n\n</code></pre> <p>root_password_sha2 =  root_username = admin <pre><code>\n### configuration du r\u00e9seau (dans le fichier de conf trouver la ligne correspondante)\n\n</code></pre> <p>rest_listen_uri = http://ip_mana:9000/api/ web_listen_uri = http://ip_mana:9000/</p> <pre><code>\n## 5.D\u00e9marrage du serveur Graylog\n\n</code></pre> <p>sudo systemctl enable graylog-server sudo systemctl start graylog-server sudo systemctl status graylog-server ```</p>"},{"location":"GRAYLOG/#6connexion-a-linterface-web","title":"6.Connexion \u00e0 l'interface Web","text":"<p>URL : http://IP_SERVEUR:9000</p> <p>Login : admin</p> <p>Mot de passe : celui d\u00e9fini lors de la configuration (root_password_sha2)</p>"},{"location":"GRAYLOG/#porblemes-rencontres-et-solutions","title":"Porbl\u00e8mes rencontr\u00e8s et solutions","text":""},{"location":"GRAYLOG/#probleme-1-mot-de-passe-graylog-invalide-sur-linterface-web","title":"Probl\u00e8me 1 : Mot de passe Graylog invalide sur l\u2019interface web","text":"<p>Impossible de se connecter avec admin</p> <p>Aucun message d\u2019erreur clair</p>"},{"location":"GRAYLOG/#probleme-2-incomprehension-du-password_secret","title":"Probl\u00e8me 2 : Incompr\u00e9hension du password_secret","text":"<p>Doute sur l\u2019utilisation d\u2019un secret g\u00e9n\u00e9r\u00e9 al\u00e9atoirement.</p> <p>Clarification :</p> <p>password_secret n\u2019est pas un mot de passe utilisateur</p> <p>Il sert \u00e0 chiffrer les donn\u00e9es sensibles stock\u00e9es par Graylog</p> <p>Il n\u2019a pas besoin d\u2019\u00eatre m\u00e9moris\u00e9</p>"},{"location":"GRAYLOG/#probleme-3-impossible-de-se-connecter-lors-de-la-toute-premiere-connexion-a-linterface-web","title":"Probl\u00e8me 3 : Impossible de se connecter lors de la toute premi\u00e8re connexion \u00e0 l\u2019interface web","text":"<p>Lors du premier d\u00e9marrage, Graylog g\u00e9n\u00e8re un mot de passe temporaire pour l\u2019utilisateur <code>admin</code>. Ce mot de passe n\u2019est visible que dans les logs.</p> <p>Commande utilis\u00e9e : sudo tail -n 50 /var/log/graylog-server/server.log</p> <p>Une ligne de ce type appara\u00eet : Initial admin password:  <p>Ce mot de passe est requis uniquement pour la premi\u00e8re connexion.</p>"},{"location":"GRAYLOG/#probleme-4-configuration-reseau-et-ports","title":"Probleme 4 : Configuration r\u00e9seau et ports","text":"<p>Par d\u00e9faut, Graylog n'\u00e9coute que sur <code>localhost</code> (127.0.0.1), ce qui emp\u00eache l'acc\u00e8s depuis d'autres machines du r\u00e9seau. Pour y rem\u00e9dier, il faut modifier le fichier de configuration <code>/etc/graylog/server/server.conf</code> :</p> <p>```ini http_bind_address = 192.168.110.110:9000</p>"},{"location":"R%C3%A9solveurDNS/","title":"installation de Unbound sous debian","text":"<p>installer les paquet</p> <pre><code>sudo apt update\nsudo apt install unbound\n</code></pre>"},{"location":"R%C3%A9solveurDNS/#creez-ou-modifiez-le-fichier-de-configuration-principal","title":"Cr\u00e9ez ou modifiez le fichier de configuration principal :","text":"<pre><code>sudo nano /etc/unbound/unbound.conf.d/custom.conf\n</code></pre> <p>\u00e9ffectuer la configuration dans ce fichier </p> <pre><code>server:## installation de Unbound sous debian\n\n&lt;img width=\"1040\" height=\"549\" alt=\"image\" src=\"https://assets.techrepublic.com/uploads/2022/06/how-to-install-unbound-dns.jpeg\"/&gt;\n\ninstaller les paquet\n\n</code></pre> <p>sudo apt update sudo apt install unbound</p> <pre><code>## Cr\u00e9ez ou modifiez le fichier de configuration principal :\n\n</code></pre> <p>sudo nano /etc/unbound/unbound.conf.d/custom.conf</p> <pre><code>\u00e9ffectuer la configuration dans ce fichier \n\n</code></pre> <p>server:         verbosity: 0         use-syslog: yes</p> <pre><code>    interface: 0.0.0.0\n    port: 53\n\n    do-not-query-localhost: no\n    access-control: 127.0.0.0/8 allow\n    access-control: ::1 allow\n    access-control: 192.168.110.0/24 allow\n    access-control: 172.28.128.0/24 allow\n    access-control: 192.168.18.0/24 allow\n    access-control: 172.28.129.0/24 allow\n    access-control: 172.28.159.0/25 allow\n</code></pre> <p>forward-zone:         name: \"sportludique.fr\"         forward-addr: 121.183.90.205</p>"},{"location":"R%C3%A9solveurDNS/#forward-zone","title":"forward-zone:","text":"<pre><code>   # name: \"brg.bourges.sportludique.fr\"\n   # forward-addr: 172.28.128.2\n</code></pre> <p>forward-zone:         name: \"bourge.sportludique.fr\"         forward-addr: 172.28.128.70  ```</p>"},{"location":"R%C3%A9solveurDNS/#redemarrer-unbound-apres-avoir-modifier-la-configuration","title":"red\u00e9marrer unbound apr\u00e8s avoir modifier la configuration","text":"<pre><code>sudo systemctl restart unbound\n</code></pre>"},{"location":"R%C3%A9solveurDNS/#pour-verifier-le-fonctionnement-de-la-configuration-tester-une-resolution-depuis-le-serveur","title":"Pour v\u00e9rifier le fonctionnement de la configuration, tester une r\u00e9solution depuis le serveur","text":"<pre><code>dig @127.0.0.1 www.google.com\n</code></pre>"},{"location":"R%C3%A9solveurDNS/#puis-faire-le-test-sur-un-poste-externe","title":"Puis faire le test sur un poste externe","text":"<p>machine windows</p> <pre><code>nslookup www.google.com 192.168.x.x\n</code></pre> <pre><code>    verbosity: 0\n    use-syslog: yes\n\n    interface: 0.0.0.0\n    port: 53\n\n    do-not-query-localhost: no\n    access-control: 127.0.0.0/8 allow\n    access-control: ::1 allow\n    access-control: 192.168.110.0/24 allow\n    access-control: 172.28.128.0/24 allow\n    access-control: 192.168.18.0/24 allow\n    access-control: 172.28.129.0/24 allow\n    access-control: 172.28.159.0/25 allow\n</code></pre> <p>forward-zone:         name: \"sportludique.fr\"         forward-addr: 121.183.90.205</p>"},{"location":"R%C3%A9solveurDNS/#forward-zone_1","title":"forward-zone:","text":"<pre><code>   # name: \"brg.bourges.sportludique.fr\"\n   # forward-addr: 172.28.128.2\n</code></pre> <p>forward-zone:         name: \"bourge.sportludique.fr\"         forward-addr: 172.28.128.70  ```</p>"},{"location":"R%C3%A9solveurDNS/#redemarrer-unbound-apres-avoir-modifier-la-configuration_1","title":"red\u00e9marrer unbound apr\u00e8s avoir modifier la configuration","text":"<pre><code>sudo systemctl restart unbound\n</code></pre>"},{"location":"R%C3%A9solveurDNS/#pour-verifier-le-fonctionnement-de-la-configuration-tester-une-resolution-depuis-le-serveur_1","title":"Pour v\u00e9rifier le fonctionnement de la configuration, tester une r\u00e9solution depuis le serveur","text":"<pre><code>dig @127.0.0.1 www.google.com\n</code></pre>"},{"location":"R%C3%A9solveurDNS/#puis-faire-le-test-sur-un-poste-externe_1","title":"Puis faire le test sur un poste externe","text":"<p>machine windows</p> <pre><code>nslookup www.google.com 192.168.x.x\n</code></pre>"},{"location":"R%C3%A9solveurDNS/#dans-lactive-directory","title":"Dans l'active directory","text":"<p>Aller dans le gestionnaire DNS puis mettre l'ip du r\u00e9solveur en temps que redirecteur.</p>"},{"location":"activedirectory/","title":"Activedirectory","text":""},{"location":"activedirectory/#configuration-du-serveur-activedirectory-et-de-ses-services-dhcp-dns-etc","title":"Configuration du serveur ActiveDirectory et de ses services DHCP, DNS etc...","text":""},{"location":"activedirectory/#installation-des-roles-necessaires","title":"Installation des roles n\u00e9cessaires","text":"<ul> <li>On selectionne le bon serveur avec le bon nom et la bonne adresse IP configur\u00e9e pr\u00e9c\u00e9demment et on clique sur SUIVANT</li> </ul> <p>Lors de l\u2019installation du serveur, il est essentiel de s\u00e9lectionner l\u2019option permettant l\u2019ajout de r\u00f4les, services de r\u00f4le et fonctionnalit\u00e9s. Ceci permet d\u2019installer les services fondamentaux :</p> <ul> <li> <p>Active Directory Domain Services (AD DS)</p> </li> <li> <p>DHCP Server</p> </li> <li> <p>DNS Server</p> </li> <li> <p>Contr\u00f4leur de domaine</p> </li> </ul> <p></p> <p>Les fonctionnalit\u00e9s n\u00e9cessaires sont s\u00e9lectionn\u00e9es automatiquement par l\u2019assistant,il n\u2019est donc pas n\u00e9cessaire de les modifier.</p>"},{"location":"activedirectory/#configuration-dhcp-exemple-dun-reseau","title":"Configuration DHCP (exemple d'un r\u00e9seau)","text":"<p>le DHCP permet d\u2019attribuer automatiquement des adresses IP aux ordinateurs du r\u00e9seau.</p>"},{"location":"activedirectory/#1creation-de-letendue","title":"1.Cr\u00e9ation de l'\u00e9tendue","text":"<p>Une \u00e9tendue DHCP d\u00e9finit la plage d\u2019adresses IP qui pourra \u00eatre attribu\u00e9e aux clients du r\u00e9seau. - Donner un nom et une description \u00e0 l\u2019\u00e9tendue (ex. : \"DHCP_R\u00e9seau_Local\")</p> <p></p> <ul> <li>Renseigner l\u2019adresse IP de d\u00e9but et l\u2019adresse IP de fin.</li> <li>D\u00e9finir le masque de sous-r\u00e9seau (notation d\u00e9cimale ou CIDR).</li> </ul> <p></p> <ul> <li>Possibilit\u00e9 d\u2019exclure certaines adresses IP (ex : celles d\u2019un routeur, d\u2019un serveur ou d\u2019un autre \u00e9quipement fixe).</li> </ul> <p></p> <ul> <li>D\u00e9finir la dur\u00e9e du bail DHCP,c\u2019est-\u00e0-dire le temps pendant lequel un client peut utiliser une adresse IP attribu\u00e9e.</li> </ul> <p></p> <ul> <li>Ajouter l\u2019adresse IP de la passerelle par d\u00e9faut (souvent l\u2019IP du routeur). </li> </ul> <p></p> <ul> <li>Indiquer le nom du serveur DNS (ex. : domaine.local).</li> <li>Tester la r\u00e9solution DNS avec l\u2019option \u201cR\u00e9soudre\u201d afin de v\u00e9rifier que l\u2019Active Directory est bien joignable.</li> </ul> <p></p> <ul> <li>Possibilit\u00e9 d\u2019activer imm\u00e9diatement l\u2019\u00e9tendue, ou de la laisser inactive pour une utilisation future.</li> </ul>"},{"location":"apache2/","title":"\ud83e\uddf1 Documentation Apache2 \u2013 Serveur Web","text":""},{"location":"apache2/#introduction-a-apache2","title":"Introduction \u00e0 Apache2","text":""},{"location":"apache2/#installation-dapache2","title":"Installation d'Apache2","text":"<ul> <li><code>sudo apt install apache2</code></li> </ul>"},{"location":"apache2/#commandes-utiles","title":"Commandes utiles","text":"<ul> <li>Pour arr\u00eater apache2 : <code>sudo systemctl stop apache2</code></li> <li>Pour lancer apache2 : <code>sudo systemctl start apache2</code></li> <li>Pour relancer apache2 : <code>sudo systemctl restart apache2</code></li> <li>Pour recharger la configuration d'apache2 : <code>sudo systemctl reload apache2</code></li> <li>Pour voir la version d'Apache utilis\u00e9e : <code>sudo apache2ctl -v ou a2query -v</code></li> <li>Pour tester l'ensemble de la configuration d'Apache : <code>sudo apache2ctl -t</code></li> <li>Pour lister les h\u00f4tes virtuels charg\u00e9s : <code>a2query -s</code></li> <li>Pour lister les h\u00f4tes virtuels charg\u00e9s et leurs configurations : <code>sudo apache2ctl -S</code></li> <li>Pour tester la configuration des h\u00f4tes virtuels : <code>sudo apache2ctl -t -D DUMP_VHOSTS</code></li> <li>Pour voir les modules d'Apache charg\u00e9s : <code>sudo apache2ctl -M ou a2query -m</code></li> </ul>"},{"location":"dns/","title":"\ud83e\uddf1 Documentation BIND9 \u2013 Serveur DNS","text":""},{"location":"dns/#introduction-a-bind9","title":"Introduction \u00e0 BIND9","text":"<p>BIND (Berkeley Internet Name Domain) est le serveur DNS le plus r\u00e9pandu dans le monde Linux/Unix. La version actuelle, BIND9, g\u00e8re :</p> <ul> <li> <p>La r\u00e9solution DNS (nom \u2194 IP)</p> </li> <li> <p>Les zones primaires et secondaires</p> </li> <li> <p>Le transfert de zones</p> </li> <li> <p>Les requ\u00eates r\u00e9cursives</p> </li> <li> <p>Les enregistrements DNS (A, AAAA, CNAME, MX, etc.)</p> </li> </ul> <p>Cette configuration met en place deux vues DNS distinctes pour le domaine <code>bourges.sportludique.fr</code>. Elle permet de distinguer les r\u00e9ponses internes et externes, renfor\u00e7ant la s\u00e9curit\u00e9 et la flexibilit\u00e9 du r\u00e9seau.</p>"},{"location":"dns/#commandes-utiles","title":"Commandes Utiles:","text":"<p><code>dig : dig [nom_domaine] [type_enregistrement, IPV4]</code> <code>nslookup [nom_domaine] [serveur_DNS]</code></p> Zone Serveur Role Adresse IP LAN Unbound R\u00e9solveur Interne 192.168.110.80 DMZ Bind9 DNS PUBLIC (Autorit\u00e9) 192.168.18.70 Firewall PAT UDP:TCP 53 Redirection DNS vers DMZ 192.168.18.1 Internet Clients externes Acc\u00e8s au DNS public"},{"location":"dns/#installation","title":"Installation","text":"<p>Sous debian/Ubuntu <code>sudo apt update</code> <code>sudo apt install bind9 bind9-utils bind9-doc</code></p>"},{"location":"dns/#arborescence","title":"Arborescence","text":"Fichier / Dossier Role /etc/bind/named.conf Fichier principal de configuration /etc/bind/named.conf.options Options globales (forwarders, r\u00e9cursivit\u00e9\u2026) /etc/bind/named.conf.local D\u00e9finition des zones locales /etc/bind/db.interne Fichier de zone interne /etc/bind/db.externe Fichier de zone externe"},{"location":"dns/#fichier-de-configuration-principal","title":"Fichier de configuration principal","text":"<p>Chemin :<code>/etc/bin/named.conf.options</code></p> <pre><code>acl \"reseaux_lan\" {\n    172.28.128.0/24;\n    172.28.129.0/24;\n    172.28.159.0/25;\n    192.168.18.0/24;\n};\n\noptions {\n    directory \"/var/cache/bind\";\n\n    // forwarders {\n    //      183.44.18.1;\n    // };\n\n    dnssec-validation no;\n    recursion no;\n\n    allow-query { localhost; reseaux_lan; };\n    listen-on { any; };\n    listen-on port 53 {183.44.18.1;};\n    listen-on-v6 { any; };\n};\n</code></pre>"},{"location":"dns/#configuration-dune-zone-dns","title":"Configuration d'une zone DNS","text":"<p>D\u00e9claration des zone n\u00e9cessaires Chemin :<code>/etc/bind/named.conf.local</code></p> <pre><code>//\n// Do any local configuration here\n//\n\n// Consider adding the 1918 zones here, if they are not used in your\n// organization\n//include \"/etc/bind/zones.rfc1918\";\n\n\nview \"interne\" {\n    match-clients { reseaux_lan; };\n\n    recursion no;\n\n    zone \"bourges.sportludique.fr\" {\n        type master;\n        file \"/etc/bind/db.interne\";\n    };\n\n};\n\n\n\n\n\n\n\nview \"externe\" {\n    match-clients {\n        any;\n    };\n\n    recursion no;\n\n    zone \"bourges.sportludique.fr\" {\n        type master;\n        file \"/etc/bind/db.externe\";\n        allow-query { any; };\n        allow-transfer { none; };\n    };\n};\n</code></pre>"},{"location":"dns/#creer-le-fichier-de-zone-dbinterne-et-dbexterne","title":"Cr\u00e9er le fichier de zone db.interne et db.externe","text":"<p>Chemin : <code>/etc/bind/db.interne</code> et <code>/etc/bind/db.externe</code> Fichier : <code>db.interne</code></p> <pre><code>$TTL 86400\n@   IN SOA ns1.bourges.sportludique.fr. admin.bourges.sportludique.fr. (\n       2025101309 ; Serial\n       3600       ; Refresh\n       1800       ; Retry\n       1209600    ; Expire\n       86400     ; Negative Cache TTL\n)\n@   IN NS ns1.bourges.sportludique.fr.\n\nns1 IN A 172.28.128.10\n@   IN A 172.28.128.10\n</code></pre> <p>Fichier : <code>db.externe</code></p> <pre><code>$TTL 86400\n@   IN SOA ns1.bourges.sportludique.fr. admin.bourges.sportludique.fr. (\n        2025101308 ; Serial\n        3600\n        1800\n        1209600\n        86400 )\n\nns1 IN A 183.44.18.1\n@   IN NS ns1.bourges.sportludique.fr.\n\n@       IN A 183.44.18.1\nwww     IN A 183.44.18.1\nbourges IN A 183.44.18.1\n</code></pre>"},{"location":"dns/#modifier-le-fichier-hosts","title":"Modifier le fichier Hosts","text":"<p>Chemin : <code>/etc/hosts</code></p> <pre><code>127.0.0.1 bourges\n192.168.110.70  BIND9\n\n# The following lines are desirable for IPv6 capable hosts\n::1     localhost ip6-localhost ip6-loopback\nff02::1 ip6-allnodes\nff02::2 ip6-allrouters\n</code></pre>"},{"location":"dns/#modifier-le-resolvconf-pour-mettre-le-dns-du-professeur","title":"Modifier le resolv.conf pour mettre le DNS du Professeur","text":"<p>Chemin : <code>/etc/resolv.conf</code></p> <pre><code># Generated by dhcpcd\n# /etc/resolv.conf.head can replace this line\n# /etc/resolv.conf.tail can replace this line\nnameserver 121.183.90.205\n</code></pre>"},{"location":"dns/#verification-de-la-configuration","title":"V\u00e9rification de la configuration","text":"<ul> <li>sudo named-checkconf</li> <li>sudo systemctl restart bind9</li> <li>sudo named-checkzone  <code>/etc/bind/db.interne</code> et <code>/etc/bind/db.externe</code></li> </ul>"},{"location":"dns/#configuration-du-pat-sur-le-routeur-udp-et-tcp-53","title":"Configuration du PAT sur le ROUTEUR UDP ET TCP 53","text":""},{"location":"dns/#configuration-du-pat-sur-le-firewall","title":"Configuration du PAT sur le Firewall","text":"<p>DEMAIN 14/10/2025 (AMINE)</p>"},{"location":"docker/","title":"Docker sur Debian \u2013 Documentation (avec erreurs rencontr\u00e9es)","text":""},{"location":"docker/#1-presentation-rapide","title":"1. Pr\u00e9sentation rapide","text":"<p>Docker permet de lancer des applications dans des conteneurs l\u00e9gers, isol\u00e9s du syst\u00e8me h\u00f4te, tout en partageant le m\u00eame noyau que la machine. Par opposition, la virtualisation avec un hyperviseur (Proxmox, VMware, etc.) fait tourner des VM compl\u00e8tes, chacune avec son OS, ce qui consomme plus de ressources CPU/RAM/stockage.</p>"},{"location":"docker/#2-installation-de-docker-sur-debian","title":"2. Installation de Docker sur Debian","text":""},{"location":"docker/#21-prerequis","title":"2.1. Pr\u00e9\u2011requis","text":"<ul> <li>sudo apt update</li> <li>sudo apt install ca-certificates curl gnupg lsb-release -y</li> </ul>"},{"location":"docker/#22-ajout-du-depot-officiel-docker","title":"2.2. Ajout du d\u00e9p\u00f4t officiel Docker","text":"<ul> <li>sudo install -m 0755 -d /usr/share/keyrings</li> <li>curl -fsSL https://download.docker.com/linux/debian/gpg | sudo gpg --dearmor -o /usr/share/keyrings/docker.gpg</li> <li>sudo chmod a+r /usr/share/keyrings/docker.gpg</li> </ul> <p>-echo \"deb [arch=$(dpkg --print-architecture) signed-by=/usr/share/keyrings/docker.gpg]  https://download.docker.com/linux/debian $(lsb_release -cs) stable\" | sudo tee /etc/apt/sources.list.d/docker.list &gt; /dev/null</p>"},{"location":"docker/#23-installation-de-docker-engine-plugin-compose","title":"2.3. Installation de Docker Engine + plugin Compose","text":"<ul> <li>sudo apt update</li> <li>sudo apt install docker-ce docker-ce-cli containerd.io</li> <li> <p>docker-buildx-plugin docker-compose-plugin -y</p> </li> <li> <p>docker --version</p> </li> <li>docker compose version</li> <li>sudo systemctl enable --now docker</li> </ul>"},{"location":"docker/#31-structure-de-projet","title":"3.1. Structure de projet","text":"<ul> <li>mkdir ~/node-docker-demo</li> <li>cd ~/node-docker-demo</li> <li>npm init -y</li> <li>npm install Cr\u00e9er <code>app.js</code> : const http = require('http');</li> </ul> <p>const server = http.createServer((req, res) =&gt; { res.statusCode = 200; res.setHeader('Content-Type', 'text/plain'); res.end('Hello, Docker!\\n'); });</p> <p>const port = process.env.PORT || 3000;</p> <p>server.listen(port, () =&gt; { console.log(Server running on http://localhost:${port}); });</p> <p>Cr\u00e9er <code>Dockerfile</code> : FROM node:18-alpine</p> <p>WORKDIR /usr/src/app</p> <p>COPY package*.json ./ RUN npm install</p> <p>COPY . .</p> <p>EXPOSE 3000</p> <p>CMD [\"node\", \"app.js\"]</p>"},{"location":"docker/#32-fichier-docker-composeyml-minimal","title":"3.2. Fichier <code>docker-compose.yml</code> minimal","text":"<p>version: \"3\" services: app: build: context: . ports: - \"3000:3000\"</p>"},{"location":"docker/#33-lancement","title":"3.3. Lancement","text":"<ul> <li>docker compose up -d # lancement en arri\u00e8re-plan</li> <li>docker compose ps # \u00e9tat des conteneurs</li> <li>docker compose down # arr\u00eat + suppression des conteneurs</li> </ul> <p>L\u2019application est ensuite accessible sur http://IP_DEBIAN:3000.</p>"},{"location":"docker/#4-notions-importantes","title":"4. Notions importantes","text":""},{"location":"docker/#41-mappage-de-ports","title":"4.1. Mappage de ports","text":"<p>Dans <code>docker-compose.yml</code> : ports: \"3000:3000\"</p> <ul> <li>1er nombre : port h\u00f4te </li> <li>2e nombre : port conteneur</li> </ul> <p>Exemples : - <code>8080:80</code> \u2192 http://IP:8080 pointe vers le port 80 du conteneur (classique pour Nginx/Apache). - <code>0:3000</code> ou <code>3000</code> \u2192 Docker choisit un port dispo sur l\u2019h\u00f4te, consultable avec <code>docker compose ps</code>.</p>"},{"location":"docker/#42-volumes-persistance-des-donnees","title":"4.2. Volumes (persistance des donn\u00e9es)","text":"<p>Exemple simple en ligne de commande :</p>"},{"location":"docker/#5-commandes-docker-de-base","title":"5. Commandes Docker de base","text":"<ul> <li><code>docker pull &lt;image&gt;</code> : T\u00e9l\u00e9charger une image (ex. <code>docker pull nginx</code>)</li> <li><code>docker images</code> : Lister les images locales</li> <li><code>docker ps</code> / <code>docker ps -a</code> : Lister conteneurs actifs / tous les conteneurs</li> <li><code>docker run -d -p 8080:80 nginx</code> : Lancer Nginx en arri\u00e8re\u2011plan (accessible sur http://IP:8080)</li> <li><code>docker exec -it &lt;container&gt; /bin/bash</code> : Ouvrir un shell dans un conteneur</li> <li><code>docker stop &lt;container&gt;</code> / <code>docker rm &lt;container&gt;</code> : Arr\u00eater / supprimer un conteneur</li> <li><code>docker rmi &lt;image&gt;</code> : Supprimer une image</li> <li><code>docker network ls</code> / <code>docker volume ls</code> : Lister r\u00e9seaux et volumes</li> </ul>"},{"location":"docker/#6-portainer-ui-web-pour-docker","title":"6. Portainer (UI Web pour Docker)","text":""},{"location":"docker/#61-deploiement","title":"6.1. D\u00e9ploiement","text":"<ul> <li>docker volume create portainer_data</li> </ul> <p><code>docker run -d -p 8000:8000 -p 9000:9000 --name=portainer --restart=always -v /var/run/docker.sock:/var/run/docker.sock -v portainer_data:/data portainer/portainer-ce:latest</code> Interface accessible sur http://IP_DEBIAN:9000 (cr\u00e9ation d\u2019un compte admin lors du premier acc\u00e8s).</p>"},{"location":"docker/#62-message-instance-programmee-a-des-fins-de-securite","title":"6.2. Message \u201cinstance programm\u00e9e \u00e0 des fins de s\u00e9curit\u00e9\u201d","text":"<p>Portainer coupe l\u2019assistant de premi\u00e8re installation apr\u00e8s un d\u00e9lai pour \u00e9viter une prise de contr\u00f4le non souhait\u00e9e.</p> <p>Pour le r\u00e9activer : - docker stop portainer - docker start portainer</p>"},{"location":"docker/#7-erreurs-rencontrees-et-corrections","title":"7. Erreurs rencontr\u00e9es et corrections","text":""},{"location":"docker/#71-erreur-docker-apt-failed-to-parse-keyring-usrsharekeyringsdockergpg","title":"7.1. Erreur Docker APT : Failed to parse keyring \"/usr/share/keyrings/docker.gpg\"","text":"<p>Sympt\u00f4me : <code>apt update</code> affiche :Error: Failed to parse keyring \"/usr/share/keyrings/docker.gpg\" \u2013 No such file or directory Le d\u00e9p\u00f4t https://download.docker.com/linux/debian n\u2019est pas sign\u00e9.`</p> <p>Cause : Le d\u00e9p\u00f4t Docker est configur\u00e9 avec <code>signed-by=/usr/share/keyrings/docker.gpg</code> mais ce fichier n\u2019existe pas (cl\u00e9 GPG non ajout\u00e9e).</p> <p>Correction : - sudo install -m 0755 -d /usr/share/keyrings</p> <ul> <li> <p>curl -fsSL https://download.docker.com/linux/debian/gpg | sudo gpg --dearmor -o /usr/share/keyrings/docker.gpg</p> </li> <li> <p>sudo chmod a+r /usr/share/keyrings/docker.gpg</p> </li> <li> <p>sudo apt update   V\u00e9rifier aussi que <code>/etc/apt/sources.list.d/docker.list</code> contient bien une ligne de ce type :   deb [arch=amd64 signed-by=/usr/share/keyrings/docker.gpg] https://download.docker.com/linux/debian trixie stable</p> </li> </ul>"},{"location":"docker/#72-message-portainer-votre-instance-portainer-est-programmee-a-des-fins-de-securite","title":"7.2. Message Portainer : \u201cVotre instance Portainer est programm\u00e9e \u00e0 des fins de s\u00e9curit\u00e9\u201d","text":"<p>Sympt\u00f4me : Apr\u00e8s l\u2019installation, Portainer affiche un message indiquant que l\u2019instance a expir\u00e9 pour des raisons de s\u00e9curit\u00e9 et qu\u2019il faut la red\u00e9marrer.</p> <p>Cause : L\u2019assistant de configuration initial (cr\u00e9ation de l\u2019utilisateur admin) n\u2019a pas \u00e9t\u00e9 termin\u00e9 dans le d\u00e9lai imparti.</p> <p>Correction : - docker stop portainer - docker start portainer puis se connecter imm\u00e9diatement sur http://IP_machine:9000 et terminer l\u2019assistant</p>"},{"location":"firewall/","title":"Firewall","text":""},{"location":"firewall/#connexion-au-firewall","title":"Connexion au firewall","text":"<p>Pour acc\u00e9der \u00e0 l'interface d'administration du pare-feu SNS, il est indispensable de connecter la machine cliente \u00e0 une interface interne (port LAN).</p>"},{"location":"firewall/#configuration-dusine","title":"Configuration d'usine","text":"<ul> <li>Le firewall est en mode bridge par d\u00e9faut.  </li> <li>Son adresse IP est : <code>10.0.0.254/8</code> </li> <li>Un service DHCP fournit automatiquement des adresses IP sur les ports LAN.</li> </ul>"},{"location":"firewall/#acces-a-linterface-dadministration","title":"Acc\u00e8s \u00e0 l\u2019interface d\u2019administration","text":"<ol> <li>Obtenez une adresse IP via le DHCP.  </li> <li>Ouvrez un navigateur web et acc\u00e9dez \u00e0 l\u2019interface :    \ud83d\udc49 https://ip_firewall/admin</li> </ol>"},{"location":"firewall/#identifiants-par-defaut","title":"Identifiants par d\u00e9faut","text":"<ul> <li>Identifiant : <code>admin</code> </li> <li>Mot de passe : <code>admin</code></li> </ul>"},{"location":"firewall/#configuration-generale","title":"Configuration g\u00e9n\u00e9rale","text":"<p>Par d\u00e9faut, le firewall d\u00e9connecte l'utilisateur apr\u00e8s une p\u00e9riode d'inactivit\u00e9. Il est possible de modifier ce comportement en cliquant sur la fl\u00e8che \u00e0 droite de l'ic\u00f4ne repr\u00e9sentant l'utilisateur connect\u00e9, en haut \u00e0 droite, puis sur Pr\u00e9f\u00e9rences.</p> <p></p> <p>Dans la zone Param\u00e8tres de connexion, s\u00e9lectionnez dans la liste \u00ab D\u00e9connexion en cas d'inactivit\u00e9 \u00bb la valeur : \ud83d\udc49 Toujours rester connect\u00e9</p> <p></p> <p>Pour renommer le firewall, acc\u00e9dez au menu : Configuration \u2192 Syst\u00e8me \u2192 Configuration</p> <p>Le volet Configuration g\u00e9n\u00e9rale s\u2019affiche.</p> <p>\ud83d\udca1 Conseil : Il est pr\u00e9f\u00e9rable de mettre les logs en anglais (option Langue du pare-feu (traces)) afin de faciliter les recherches de probl\u00e8mes dans la documentation Stormshield ou sur les forums, en utilisant les bons mots-cl\u00e9s.</p> <p></p>"},{"location":"firewall/#securite-changement-du-mot-de-passe-administrateur","title":"S\u00e9curit\u00e9 \u2014 Changement du mot de passe administrateur","text":"<p>Pour des raisons de s\u00e9curit\u00e9, il est n\u00e9cessaire de changer le mot de passe du firewall.</p> <p>La modification du mot de passe administrateur se fait dans : Configuration \u2192 Syst\u00e8me \u2192 Administrateurs \u2192 Onglet \"Compte ADMIN\"</p> <p></p>"},{"location":"firewall/#creation-dinterfaces","title":"Cr\u00e9ation d'interfaces","text":""},{"location":"firewall/#configuration-dune-interface-physique","title":"Configuration d'une interface physique","text":"<p>Pour configurer une interface physique, rendez-vous dans : Configuration \u2192 R\u00e9seau \u2192 Interfaces</p> <p>S\u00e9lectionnez ensuite l\u2019interface de votre choix :</p> <ul> <li>in \u2192 Interface LAN (interne au r\u00e9seau)  </li> <li>out \u2192 Interface WAN (externe, vers le routeur ou Internet)  </li> <li>DMZ \u2192 Zone d\u00e9militaris\u00e9e</li> </ul> <p>Apr\u00e8s avoir s\u00e9lectionn\u00e9 une interface, il faut la sortir du mode bridge en cochant la case Adressage dynamique/statique. Choisissez ensuite un mode d\u2019adressage : - Statique : vous entrez manuellement l\u2019adresse IP. - Dynamique (DHCP) : l\u2019adresse IP est attribu\u00e9e automatiquement.</p> <p></p>"},{"location":"firewall/#configuration-dune-interface-virtuelle-vlan","title":"Configuration d'une interface virtuelle (VLAN)","text":"<p>Pour cr\u00e9er une interface virtuelle (VLAN), proc\u00e9dez comme suit :</p> <ol> <li>Dans une interface physique, cliquez sur le bouton Ajouter (en haut de la liste).  </li> <li>Choisissez VLAN \u2192 \"nom de l\u2019interface\".</li> </ol> <p></p> <p>Une page de configuration appara\u00eet. Dans la section Configuration g\u00e9n\u00e9rale, remplissez les informations du VLAN :</p> <ul> <li>Nom : nom du VLAN  </li> <li>Interface parente : interface physique \u00e0 laquelle le VLAN est rattach\u00e9  </li> <li>Identifiant : ID du VLAN  </li> <li>Interface interne/externe : \u00e0 d\u00e9finir selon le r\u00f4le du r\u00e9seau</li> </ul> <p></p> <p>Dans la section Plan d\u2019adressage, la configuration est identique \u00e0 celle d\u2019une interface physique : - Sortez du mode bridge - Choisissez le mode Dynamique ou Statique</p> <p>En s\u00e9lectionnant IP fixe (statique), il sera possible d\u2019ajouter une adresse IP sous la forme : <code>IP/masque</code></p> <p></p>"},{"location":"firewall/#regles-de-filtrage-et-nat-politique-de-securite","title":"R\u00e8gles de filtrage et NAT (Politique de s\u00e9curit\u00e9)","text":""},{"location":"glpi/","title":"Installation compl\u00e8te de GLPI 11 sur Debian 12/13","text":"<p>Proc\u00e9dure d'installation de GLPI 11 avec Apache2, PHP-FPM et MariaDB.</p>"},{"location":"glpi/#1-presentation","title":"1. Pr\u00e9sentation","text":"<p>GLPI (Gestion Libre de Parc Informatique) est une solution web libre de gestion de parc, helpdesk et ITSM.</p> <p>GLPI 11 repose sur : - Un serveur web (Apache ou Nginx) - PHP (PHP-FPM recommand\u00e9) - Une base de donn\u00e9es MariaDB ou MySQL</p>"},{"location":"glpi/#2-prerequis","title":"2. Pr\u00e9requis","text":""},{"location":"glpi/#21-systeme-et-reseau","title":"2.1 Syst\u00e8me et r\u00e9seau","text":"<ul> <li>Debian 12 ou 13</li> <li>Acc\u00e8s root ou sudo</li> <li>IP fixe ou r\u00e9servation DHCP</li> <li>Nom DNS pointant vers le serveur GLPI</li> <li>Acc\u00e8s r\u00e9seau : SSH (administration) et HTTP/HTTPS (clients)</li> </ul>"},{"location":"glpi/#22-logiciels-requis","title":"2.2 Logiciels requis","text":"<ul> <li>Apache2</li> <li>MariaDB (\u2265 10.2) ou MySQL (\u2265 5.7)</li> <li>PHP compatible GLPI 11</li> </ul>"},{"location":"glpi/#23-extensions-php-requisesrecommandees","title":"2.3 Extensions PHP requises/recommand\u00e9es","text":"<p><code>curl</code> <code>gd</code> <code>intl</code> <code>mysqli</code> <code>session</code> <code>json</code> <code>xml</code> <code>mbstring</code> <code>zip</code> <code>bz2</code> <code>imap</code> <code>ldap</code> <code>apcu</code></p>"},{"location":"glpi/#3-mise-a-jour-du-systeme","title":"3. Mise \u00e0 jour du syst\u00e8me","text":"<p>sudo apt update &amp;&amp; sudo apt upgrade -y</p>"},{"location":"glpi/#4-installation-de-la-stack-lamp","title":"4. Installation de la stack LAMP","text":""},{"location":"glpi/#41-apache2-et-mariadb","title":"4.1 Apache2 et MariaDB","text":"<p>sudo apt install -y apache2 mariadb-server</p>"},{"location":"glpi/#42-php-fpm-et-extensions","title":"4.2 PHP-FPM et extensions","text":"<p>Adapter la version PHP : - Debian 12 \u2192 PHP 8.2 - Debian 13 \u2192 PHP 8.4</p> <p>sudo apt install -y php php-fpm php-mysql php-gd php-intl php-curl php-xml php-zip php-mbstring php-bz2 php-imap php-apcu php-ldap php-common php-json</p>"},{"location":"glpi/#5-configuration-de-mariadb","title":"5. Configuration de MariaDB","text":""},{"location":"glpi/#51-securisation","title":"5.1 S\u00e9curisation","text":"<p>sudo mysql_secure_installation</p>"},{"location":"glpi/#52-creation-de-la-base-glpi","title":"5.2 Cr\u00e9ation de la base GLPI","text":"<p>sudo mysql</p> <p>undefined</p> <p>CREATE DATABASE glpi CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci; CREATE USER 'glpiuser'@'localhost' IDENTIFIED BY 'MotDePasseFort'; GRANT ALL PRIVILEGES ON glpi.* TO 'glpiuser'@'localhost'; FLUSH PRIVILEGES; EXIT;</p>"},{"location":"glpi/#6-telechargement-de-glpi-11","title":"6. T\u00e9l\u00e9chargement de GLPI 11","text":""},{"location":"glpi/#61-recuperation","title":"6.1 R\u00e9cup\u00e9ration","text":"<p>cd /tmp wget https://github.com/glpi-project/glpi/releases/download/11.0.0/glpi-11.0.0.tgz</p>"},{"location":"glpi/#62-installation","title":"6.2 Installation","text":"<p>sudo tar xvf glpi-11.0.0.tgz -C /var/www/ sudo mv /var/www/glpi /var/www/glpi-11 sudo ln -s /var/www/glpi-11 /var/www/glpi</p>"},{"location":"glpi/#7-organisation-et-securisation-des-fichiers","title":"7. Organisation et s\u00e9curisation des fichiers","text":""},{"location":"glpi/#71-configuration-glpi","title":"7.1 Configuration GLPI","text":"<p>sudo mkdir -p /etc/glpi sudo chown www-data:www-data /etc/glpi sudo mv /var/www/glpi/config /etc/glpi</p>"},{"location":"glpi/#72-donnees-glpi","title":"7.2 Donn\u00e9es GLPI","text":"<p>sudo mkdir -p /var/lib/glpi sudo mv /var/www/glpi/files /var/lib/glpi sudo chown -R www-data:www-data /var/lib/glpi</p>"},{"location":"glpi/#73-journaux","title":"7.3 Journaux","text":"<p>sudo mkdir -p /var/log/glpi sudo chown www-data:www-data /var/log/glpi</p>"},{"location":"glpi/#8-configuration-des-chemins","title":"8. Configuration des chemins","text":""},{"location":"glpi/#81-downstreamphp","title":"8.1 downstream.php","text":"<pre><code>&lt;?php\ndefine('GLPI_CONFIG_DIR', '/etc/glpi/');\nif (file_exists(GLPI_CONFIG_DIR . '/local_define.php')) {\n    require_once GLPI_CONFIG_DIR . '/local_define.php';\n}\n</code></pre>"},{"location":"glpi/#82-local_definephp","title":"8.2 local_define.php","text":"<pre><code>sudo nano /etc/glpi/local_define.php\n</code></pre> <p>Contenu :</p> <pre><code>&lt;?php\ndefine('GLPI_VAR_DIR', '/var/lib/glpi/files');\ndefine('GLPI_LOG_DIR', '/var/log/glpi');\n</code></pre>"},{"location":"glpi/#9-permissions","title":"9. Permissions","text":"<pre><code>sudo chown -R www-data:www-data /var/www/glpi-11\nsudo chown -R www-data:www-data /etc/glpi /var/lib/glpi /var/log/glpi\nsudo find /var/www/glpi-11 -type d -exec chmod 750 {} \\;\nsudo find /var/www/glpi-11 -type f -exec chmod 640 {} \\;\n</code></pre>"},{"location":"glpi/#10-configuration-apache2","title":"10. Configuration Apache2","text":""},{"location":"glpi/#101-virtualhost-glpi","title":"10.1 VirtualHost GLPI","text":"<pre><code>sudo nano /etc/apache2/sites-available/glpi.conf\n</code></pre> <p>Contenu :</p> <pre><code>&lt;VirtualHost *:80&gt;\n    ServerName glpi.mondomaine.local\n    DocumentRoot /var/www/glpi/public\n\n    &lt;Directory /var/www/glpi/public&gt;\n        Require all granted\n        AllowOverride All\n        Options FollowSymlinks\n\n        RewriteEngine On\n        RewriteCond %{REQUEST_FILENAME} !-f\n        RewriteRule ^(.*)$ index.php [QSA,L]\n    &lt;/Directory&gt;\n\n    ErrorLog ${APACHE_LOG_DIR}/glpi-error.log\n    CustomLog ${APACHE_LOG_DIR}/glpi-access.log combined\n\n    &lt;FilesMatch \"\\.php$\"&gt;\n        SetHandler \"proxy:unix:/run/php/php8.2-fpm.sock|fcgi://localhost/\"\n        # Debian 13 / PHP 8.4 :\n        # SetHandler \"proxy:unix:/run/php/php8.4-fpm.sock|fcgi://localhost/\"\n    &lt;/FilesMatch&gt;\n&lt;/VirtualHost&gt;\n</code></pre>"},{"location":"glpi/#102-activation","title":"10.2 Activation","text":"<pre><code>sudo a2enmod proxy_fcgi setenvif rewrite\nsudo a2enconf php*-fpm\nsudo a2ensite glpi.conf\nsudo systemctl reload apache2\n</code></pre>"},{"location":"glpi/#11-parametres-php-recommandes","title":"11. Param\u00e8tres PHP recommand\u00e9s","text":"<pre><code>sudo nano /etc/php/8.2/fpm/php.ini\n</code></pre> <p>Param\u00e8tres \u00e0 ajuster :</p> <pre><code>memory_limit = 256M\nupload_max_filesize = 20M\npost_max_size = 20M\ndate.timezone = Europe/Paris\n</code></pre> <p>Red\u00e9marrer PHP-FPM :</p> <pre><code>sudo systemctl restart php8.2-fpm\n</code></pre>"},{"location":"glpi/#12-installation-via-linterface-web","title":"12. Installation via l'interface web","text":"<p>Acc\u00e9der \u00e0 :</p> <ul> <li>http://glpi.mondomaine.local</li> <li>http://IP_DU_SERVEUR</li> </ul>"},{"location":"glpi/#etapes","title":"\u00c9tapes","text":"<ol> <li>Langue \u2192 Fran\u00e7ais</li> <li>Licence GPL \u2192 Installer</li> <li> <p>Base de donn\u00e9es :</p> </li> <li> <p>H\u00f4te : <code>localhost</code></p> </li> <li>Utilisateur : <code>glpiuser</code></li> <li>Mot de passe : <code>MotDePasseFort</code></li> <li>Base : <code>glpi</code></li> </ol>"},{"location":"glpi/#comptes-par-defaut-a-modifier-immediatement","title":"Comptes par d\u00e9faut (\u00e0 modifier imm\u00e9diatement)","text":"R\u00f4le Login Mot de passe Admin glpi glpi Technicien tech tech Utilisateur normal normal Lecture seule post-only post-only"},{"location":"glpi/#13-post-installation","title":"13. Post-installation","text":""},{"location":"glpi/#131-suppression-de-linstallateur","title":"13.1 Suppression de l'installateur","text":"<pre><code>sudo find /var/www/glpi-11 -name \"install.php\" -delete\n</code></pre>"},{"location":"glpi/#133-sauvegardes","title":"13.3 Sauvegardes","text":"<p>Sauvegarder r\u00e9guli\u00e8rement :</p> <ul> <li>Base de donn\u00e9es <code>glpi</code></li> <li> <p>Dossiers :</p> </li> <li> <p><code>/etc/glpi</code></p> </li> <li><code>/var/lib/glpi</code></li> <li><code>/var/log/glpi</code></li> <li>Plugins</li> </ul>"},{"location":"glpi/#14-recapitulatif-rapide","title":"14. R\u00e9capitulatif rapide","text":"<pre><code># Mise \u00e0 jour\nsudo apt update &amp;&amp; sudo apt upgrade -y\n\n# Apache &amp; MariaDB\nsudo apt install -y apache2 mariadb-server\n\n# PHP\nsudo apt install -y \\\n  php php-fpm php-mysql php-gd php-intl php-curl php-xml php-zip \\\n  php-mbstring php-bz2 php-imap php-apcu php-ldap php-common php-json\n\n# S\u00e9curisation DB\nsudo mysql_secure_installation\n\n# Base GLPI\nsudo mysql &lt;&lt;EOF\nCREATE DATABASE glpi CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;\nCREATE USER 'glpiuser'@'localhost' IDENTIFIED BY 'MotDePasseFort';\nGRANT ALL PRIVILEGES ON glpi.* TO 'glpiuser'@'localhost';\nFLUSH PRIVILEGES;\nEOF\n\n# T\u00e9l\u00e9chargement GLPI\ncd /tmp\nwget https://github.com/glpi-project/glpi/releases/download/11.0.0/glpi-11.0.0.tgz\nsudo tar xvf glpi-11.0.0.tgz -C /var/www/\nsudo mv /var/www/glpi /var/www/glpi-11\nsudo ln -s /var/www/glpi-11 /var/www/glpi\n\n# Organisation fichiers\nsudo mkdir -p /etc/glpi /var/lib/glpi /var/log/glpi\nsudo mv /var/www/glpi/config /etc/glpi\nsudo mv /var/www/glpi/files /var/lib/glpi\nsudo chown -R www-data:www-data /etc/glpi /var/lib/glpi /var/log/glpi /var/www/glpi-11\n\n# downstream.php\ncat &lt;&lt;'PHP' | sudo tee /var/www/glpi/inc/downstream.php\n&lt;?php\ndefine('GLPI_CONFIG_DIR', '/etc/glpi/');\nif (file_exists(GLPI_CONFIG_DIR . '/local_define.php')) {\n    require_once GLPI_CONFIG_DIR . '/local_define.php';\n}\nPHP\n\n# local_define.php\ncat &lt;&lt;'PHP' | sudo tee /etc/glpi/local_define.php\n&lt;?php\ndefine('GLPI_VAR_DIR', '/var/lib/glpi/files');\ndefine('GLPI_LOG_DIR', '/var/log/glpi');\nPHP\n\n# Permissions\nsudo chown -R www-data:www-data /var/www/glpi-11 /etc/glpi /var/lib/glpi /var/log/glpi\nsudo find /var/www/glpi-11 -type d -exec chmod 750 {} \\;\nsudo find /var/www/glpi-11 -type f -exec chmod 640 {} \\;\n\n# VirtualHost Apache (\u00e0 configurer manuellement)\nsudo nano /etc/apache2/sites-available/glpi.conf\n\n# Activation\nsudo a2enmod proxy_fcgi setenvif rewrite\nsudo a2enconf php*-fpm\nsudo a2ensite glpi.conf\nsudo systemctl reload apache2\n</code></pre>"},{"location":"hmailserver/","title":"Documentation Hmail server sur Windows 10","text":""},{"location":"hmailserver/#infrastructure-des-equipements-importants","title":"Infrastructure des \u00e9quipements importants","text":"Service Adresse IP Logiciel DNS autorit\u00e9 192.168.18.70 BIND9 reverse proxy 192.168.18.50 NGINX routeur cisco 172.28.159.254 cisco 1921 serveur mail 192.168.18.102 hmail server"},{"location":"hmailserver/#configuration-dns-interne-et-externe-sur-le-serveur-dautorite","title":"Configuration DNS interne et externe sur le serveur d'autorit\u00e9","text":""},{"location":"hmailserver/#fichier-de-zone-etcbinddbinterne","title":"fichier de zone : <code>/etc/bind/db.interne</code>","text":"<pre><code>$TTL 86400\n@   IN SOA ns1.bourges.sportludique.fr. admin.bourges.sportludique.fr. (\n       2025112519\n       3600\n       1800\n       1209600\n       86400 )\n\n; Serveur DNS\n@    IN NS ns1.bourges.sportludique.fr.\nns1  IN A 172.28.128.70\n\n; Domaine principal\n@    IN A 172.28.128.70\nwww  IN A 192.168.18.50\n\n; Serveur de messagerie\nmail IN A 192.168.18.102\nsmtp IN CNAME mail\nimap IN CNAME mail\n\n; MX\n@    IN MX 10 smtp.bourges.sportludique.fr.\n\n</code></pre>"},{"location":"hmailserver/#fichier-de-zone-etcbinddbexterne","title":"fichier de zone : <code>/etc/bind/db.externe</code>","text":"<pre><code>$TTL 86400\n\n@   IN SOA ns1.bourges.sportludique.fr. admin.bourges.sportludique.fr. (\n\n       2025112516 ; Serial (AAAAMMJJNN)\n\n       3600       ; Refresh\n\n       1800       ; Retry\n\n       1209600    ; Expire\n\n       86400 )    ; Minimum TTL\n\n; Serveur DNS\n\n@    IN NS ns1.bourges.sportludique.fr.\n\nns1  IN A 183.44.18.1\n\n; Domaine principal et services web\n\n@    IN A 183.44.18.1\n\nwww  IN A 183.44.18.1\n\n; Serveur de messagerie unique\n\nsmtp IN A 183.44.18.1\n\n\n; Enregistrement MX pointant vers le serveur mail\n\n@    IN MX 10 smtp.bourges.sportludique.fr.\n\n\n</code></pre>"},{"location":"hmailserver/#regles-obligatoires-sur-r1-fibre-et-r2-adsl","title":"R\u00e8gles obligatoires sur R1-FIBRE et R2-ADSL","text":""},{"location":"hmailserver/#regles-a-mettre-en-place","title":"R\u00e8gles \u00e0 mettre en place :","text":"<pre><code>ip nat inside source static tcp 192.168.18.102 25 interface GigabitEthernet0/0 25\nip nat inside source static tcp 192.168.18.102 465 interface GigabitEthernet0/0 465\nip nat inside source static tcp 192.168.18.102 587 interface GigabitEthernet0/0 587\nip nat inside source static tcp 192.168.18.102 143 interface GigabitEthernet0/0 143\nip nat inside source static tcp 192.168.18.102 993 interface GigabitEthernet0/0 993\n</code></pre>"},{"location":"hmailserver/#installation-de-hmailserver-sous-windows","title":"Installation de HmailServer sous windows","text":"<ul> <li> <p>Hmail</p> </li> <li> <p>Framework</p> </li> </ul>"},{"location":"hmailserver/#configuration-de-hmailserver","title":"Configuration de HmailServer","text":""},{"location":"hmailserver/#lancement-hmailserver-et-renseigner-le-nom-de-domaine-correspondant-au-votre","title":"Lancement Hmailserver et renseigner le nom de domaine correspondant au votre","text":""},{"location":"hmailserver/#protocoles-necessaires-au-bon-fonctionnement-de-hmailserver-smtp-envoyer-des-mails-imap-recevoir-des-mails","title":"Protocoles n\u00e9cessaires au bon fonctionnement de hMailServer (SMTP: Envoyer des mails, IMAP: Recevoir des mails)","text":""},{"location":"hmailserver/#resolution-du-message-mx-lookup-failed-name-not-resolved-dans-les-logs","title":"R\u00e9solution du m\u00e9ssage \"MX lookup failed: name not resolved\" dans les logs","text":"<p>Le DNS interne ne retournait pas correctement smtp.bourges.sportludique.fr  probl\u00e8me corrig\u00e9 en ajoutant dans le serveur d'autorit\u00e9 (interne):</p> <p><code>smtp IN CNAME mail  mail IN A 192.168.18.102</code></p>"},{"location":"hmailserver/#partie-thunderbird","title":"Partie Thunderbird","text":"<pre><code>- Tout d\u2019abord, installer Thunderbird puis cliquer sur \u00ab Configurer une adresse de messagerie \u00bb avec une adresse cr\u00e9\u00e9e sur hMailServer sous Windows.\n\n- S\u00e9lectionner votre compte, puis appuyer sur Continuer.\n</code></pre> <p>Si cela ne marche pas :</p> <pre><code>Cliquer sur Configuration manuelle.\n</code></pre> <p></p>"},{"location":"hmailserver/#serveur-entrant","title":"Serveur entrant","text":"<pre><code>Protocole : IMAP\nNom d\u2019h\u00f4te : .domain.tld (votre propre domaine avec un \u00ab . \u00bb au d\u00e9but)\nPort : 143\nNom d\u2019utilisateur : nom@nomdedomaine.fr\n</code></pre>"},{"location":"hmailserver/#serveur-sortant","title":"Serveur sortant","text":"<pre><code>Nom d\u2019h\u00f4te : .domain.tld (votre propre domaine avec un \u00ab . \u00bb au d\u00e9but)\nPort : 25 (SMTP)\nNom d\u2019utilisateur : nom@nomdedomaine.fr (cr\u00e9\u00e9 pr\u00e9c\u00e9demment sur hMailServer)\n</code></pre> <p>Ensuite, cliquer sur Terminer : la connexion devrait fonctionner si la configuration du serveur est correcte.</p>"},{"location":"hmailserver/#interface-graphique-apres-connexion-reussie","title":"Interface graphique apr\u00e8s connexion r\u00e9ussie","text":""},{"location":"nxlog/","title":"NXLog CE \u2013 Collecte de logs Windows vers Graylog","text":""},{"location":"nxlog/#1-presentation","title":"1. Pr\u00e9sentation","text":"<p>NXLog CE est un agent l\u00e9ger de collecte de logs pour Windows et Linux. Il permet : - La collecte d\u2019EventLogs Windows. - La conversion en formats standard (GELF, Syslog, JSON). - L\u2019envoi vers un serveur de log centralis\u00e9 (Graylog, ELK, etc.).</p> <p>Version utilis\u00e9e : NXLog CE 3.2.2329 (Windows) Objectif : Envoyer les EventLogs Windows en GELF UDP vers Graylog.</p>"},{"location":"nxlog/#2-installation","title":"2. Installation","text":""},{"location":"nxlog/#etapes-sur-windows","title":"\u00c9tapes sur Windows","text":"<ol> <li>T\u00e9l\u00e9charger NXLog CE depuis le site officiel : https://nxlog.co/products/nxlog-community-edition/download</li> <li>Ex\u00e9cuter l\u2019installateur <code>.msi</code> et suivre les \u00e9tapes.</li> <li>Choisir C:\\Program Files\\nxlog comme dossier d\u2019installation.</li> <li>V\u00e9rifier le service NXLog : powershell</li> </ol> <pre><code>Get-Service nxlog\n</code></pre>"},{"location":"nxlog/#3-arborescence-principale","title":"3. Arborescence principale","text":"<p>C:\\Program Files\\nxlog\\conf : fichiers de configuration principaux.</p> <p>C:\\Program Files\\nxlog\\conf\\nxlog.d : fichiers de configuration modulaires.</p> <p>C:\\Program Files\\nxlog\\data : logs et spool.</p> <p>C:\\Program Files\\nxlog\\modules : modules NXLog (xm_syslog, xm_gelf, etc.)</p>"},{"location":"nxlog/#4-configuration-nxlog","title":"4. Configuration NXLog","text":"<p>Fichier principal : <code>nxlog.conf</code></p> <p>Fichier principal : nxlog.conf</p> <pre><code>define ROOT     C:\\Program Files\\nxlog\ndefine CONFDIR  %ROOT%\\conf\\nxlog.d\ndefine LOGDIR   %ROOT%\\data\n\nLogFile %LOGDIR%\\nxlog.log\nModuledir %ROOT%\\modules\nCacheDir  %LOGDIR%\nPidfile   %LOGDIR%\\nxlog.pid\nSpoolDir  %LOGDIR%\n\n# Extensions n\u00e9cessaires\n&lt;Extension gelf&gt;\n    Module xm_gelf\n&lt;/Extension&gt;\n\n&lt;Extension _charconv&gt;\n    Module xm_charconv\n    AutodetectCharsets iso8859-2, utf-8, utf-16, utf-32\n&lt;/Extension&gt;\n\n# Input : EventLogs Windows\n&lt;Input in&gt;\n    Module im_msvistalog\n&lt;/Input&gt;\n\n# Output : GELF UDP vers Graylog\n&lt;Output out&gt;\n    Module om_udp\n    Host 192.168.110.110        # IP du serveur Graylog\n    Port 12201                  # Port du input GELF UDP sur Graylog\n    Exec to_gelf();             # Conversion en GELF\n&lt;/Output&gt;\n\n# Route\n&lt;Route r1&gt;\n    Path in =&gt; out\n&lt;/Route&gt;\n</code></pre>"},{"location":"nxlog/#points-cles","title":"Points cl\u00e9s","text":"<p>Extensions : <code>xm_gelf</code> pour GELF, xm_charconv pour encodages Windows.</p> <p>Input Modules : <code>im_msvistalog</code> pour r\u00e9cup\u00e9rer tous les EventLogs.</p> <p>Output Modules : <code>om_udp ou om_tcp</code> avec Exec to_gelf().</p> <p>Routes : relient input \u2192 output, indispensables pour que les logs soient envoy\u00e9s.</p>"},{"location":"opensense/","title":"Opensense","text":""},{"location":"opensense/#documentation-opnsense","title":"Documentation OPNsense","text":"<p>Architecture \u2013 Interfaces \u2013 Routage \u2013 NAT \u2013 Notes importantes</p>"},{"location":"opensense/#1presentation-generale","title":"1.Pr\u00e9sentation g\u00e9n\u00e9rale","text":"<p>Ce syst\u00e8me OPNsense joue le r\u00f4le de pare-feu et passerelle dans une architecture comprenant plusieurs r\u00e9seaux :</p> <p>Un r\u00e9seau interne LAN</p> <p>Un r\u00e9seau DMZ (via WAN)</p> <p>Un r\u00e9seau d\u2019interconnexion avec un switch c\u0153ur (OPT1)</p> <p>Il assure : \u2714 le routage entre r\u00e9seaux \u2714 certaines routes statiques vers un firewall Stormshield \u2714 une r\u00e8gle NAT interne anti-lockout \u2714 la gestion de plusieurs passerelles</p>"},{"location":"opensense/#2interfaces-configurees","title":"2.Interfaces configur\u00e9es","text":""},{"location":"opensense/#21-interface-lan","title":"2.1 Interface LAN","text":"<p>Nom : LAN Adresse IP : 192.168.110.98 R\u00f4le : Interface de gestion (acc\u00e8s GUI OPNsense)</p>"},{"location":"opensense/#22-interface-wan","title":"2.2 Interface WAN","text":"<p>Nom : WAN Adresse IP : 192.168.18.2</p> <p>R\u00e9seau : DMZ Passerelle associ\u00e9e : Passerelle-Stormshield \u2013 192.168.18.1 R\u00f4le : Sortie vers le firewall Stormshield et vers d'autres r\u00e9seaux via celui-ci.</p>"},{"location":"opensense/#23-interface-opt1","title":"2.3 Interface OPT1","text":"<p>Nom : OPT1 Adresse IP : 172.28.159.126 /25</p>"},{"location":"opensense/#3-routage","title":"3. Routage","text":"<p>Les routes configur\u00e9es dans Syst\u00e8me \u2192 Routes \u2192 Configuration sont les suivantes :</p> R\u00e9seau destination Passerelle Description Activ\u00e9e ou D\u00e9sactiv\u00e9 172.28.129.0/24 Passerelle-Stormshield (192.168.18.1) Client Oui/Non (\u00e0 pr\u00e9ciser) 172.28.128.0/24 Passerelle-Stormshield (192.168.18.1) Serveur Oui/Non (\u00e0 pr\u00e9ciser) 0.0.0.0/0 Passerelle-Stormshield (192.168.18.1) Route par d\u00e9faut \u2714 activ\u00e9e"},{"location":"opensense/#signification","title":"Signification:","text":"<ul> <li> <p>La route par d\u00e9faut envoie tout le trafic vers le Stormshield.</p> </li> <li> <p>Deux r\u00e9seaux internes 172.28.128.0/24 et 172.28.129.0/24 sont atteints via cette m\u00eame passerelle.</p> </li> </ul>"},{"location":"opensense/#pare-feu-nat-redirection-de-port","title":"Pare-feu: NAT: Redirection de port","text":"Interface LAN Proto Adresse Ports Adresse Ports IP Ports Description LAN TCP * * LAN adresse 80,443 * * R\u00e8gle anti-Lockout <ul> <li>Cette r\u00e8gle emp\u00eache de te verrouiller en bloquant l\u2019acc\u00e8s \u00e0 l\u2019interface Web (HTTP/HTTPS) depuis le LAN.</li> <li>HTTP (80)</li> <li>HTTPS (443) \u2192 vers l\u2019IP LAN pour la GUI</li> </ul>"},{"location":"opensense/#5-passerelles-configurees","title":"5. Passerelles configur\u00e9es","text":""},{"location":"opensense/#51-passerelle-stormshield","title":"5.1 Passerelle Stormshield","text":"<p>IP : 192.168.18.1 Interface associ\u00e9e : WAN</p> <p>Utilis\u00e9e pour : \u2714 route par d\u00e9faut \u2714 r\u00e9seaux 172.28.129.0/24 et 172.28.128.0/24</p>"},{"location":"opensense/#52-passerelle-switch-core","title":"5.2 Passerelle Switch Core","text":"<p>IP : 172.28.159.1 Interface : OPT1</p>"},{"location":"opensense/#6schema-logique","title":"6.Sch\u00e9ma Logique:","text":"<pre><code>    +----------------------+\n    |     Switch Core      |\n    | 172.28.159.1         |\n    +----------+-----------+\n               |\n     OPT1: 172.28.159.126/25\n               |\n    +----------v-----------+\n    |       OPNsense       |\n    |-----------------------|\n    | 192.168.110.98 -&gt; LAN |\n    | 192.168.18.2   -&gt; WAN |\n    +----------+------------+\n               |\n    +----------v-----------+\n    |   Firewall Stormshield |\n    |    192.168.18.1        |\n    +------------------------+\n</code></pre>"},{"location":"openssl/","title":"Openssl","text":""},{"location":"openssl/#partie-serveur-dautorite-de-certification-openssl","title":"Partie serveur d'autorit\u00e9 de certification (openssl)","text":""},{"location":"openssl/#mise-a-jour-du-systeme","title":"Mise a jour du systeme","text":"<p>Nous ferons toute les manipulation sur un machine virtuel sous debian</p> <pre><code>sudo apt update &amp;&amp; sudo apt upgrade -y\n\n</code></pre>"},{"location":"openssl/#installation-dopenssl","title":"Installation d\u2019OpenSSL","text":"<pre><code>sudo apt install openssl -y\n</code></pre>"},{"location":"openssl/#arborescence-pour-les-certificats","title":"Arborescence pour les certificats","text":"<pre><code>mkdir -p ~/tpssl/autorite/certificats\nmkdir -p ~/tpssl/autorite/keys\nmkdir -p ~/tpssl/siteweb/{certificats,keys,requests_certificats}\n</code></pre>"},{"location":"openssl/#creation-de-la-cle-privee-de-la-ca","title":"Cr\u00e9ation de la cl\u00e9 priv\u00e9e de la CA","text":"<pre><code>openssl genrsa -des3 2048 &gt; ~/tpssl/autorite/keys/private_ca.key\n</code></pre>"},{"location":"openssl/#creation-du-certificat-de-la-ca","title":"Cr\u00e9ation du certificat de la CA","text":"<pre><code>openssl req -new -x509 -days 365 \\\n  -key ~/tpssl/autorite/keys/private_ca.key \\\n  -out ~/tpssl/autorite/certificats/ca.crt\n</code></pre> <p>-new -x509 : cr\u00e9e un certificat auto-sign\u00e9 pour la CA.</p> <p>-days 365 : validit\u00e9 du certificat.</p> <p>Informations \u00e0 renseigner lors de l\u2019invite :</p> <p>Country Name (FR)</p> <p>State or Province Name</p> <p>Locality Name</p> <p>Organization Name</p> <p>Common Name (nom de la CA, ex: CA-Bourges)</p> <p>Email Address</p> <p>Note : Ici, le certificat de la CA est sign\u00e9 par lui-m\u00eame, mais il servira \u00e0 signer les certificats des serveurs.</p>"},{"location":"openssl/#creation-du","title":"Cr\u00e9ation du","text":"<pre><code>La cl\u00e9 priv\u00e9e de la CA reste sur la VM CA.\n\nTous les certificats serveurs doivent \u00eatre sign\u00e9s par cette CA pour \u00eatre reconnus comme valides par le reverse proxy ou les clients internes.\n\nCette m\u00e9thode \u00e9vite les certificats auto-sign\u00e9s c\u00f4t\u00e9 serveur, le serveur web utilise un certificat sign\u00e9 par la CA interne.\n</code></pre> <p>certificat serveur via la CA</p>"},{"location":"openssl/#generation-de-la-cle-privee-du-serveur","title":"g\u00e9neration de la cl\u00e9 priv\u00e9e du serveur:","text":"<pre><code>openssl genrsa 2048 &gt; ~/tpssl/siteweb/keys/siteweb.key\n</code></pre>"},{"location":"openssl/#creation-de-la-demande-de-certificat-csr","title":"Cr\u00e9ation de la demande de certificat (CSR) :","text":"<pre><code>openssl req -new -key ~/tpssl/siteweb/keys/siteweb.key \\\n  -out ~/tpssl/siteweb/requests_certificats/siteweb.csr \\\n  -config ~/tpssl/openssl-site.cnf\n</code></pre> <p>Remplir les informations demand\u00e9es, le Common Name doit correspondre au domaine du site.</p> <p>Assurez-vous que le fichier de config OpenSSL contient la section subjectAltName pour SAN.</p>"},{"location":"openssl/#signature-de-la-demande-par-la-ca","title":"Signature de la demande par la CA :","text":"<pre><code>openssl x509 -req \\\n  -in ~/tpssl/siteweb/requests_certificats/siteweb.csr \\\n  -CA ~/tpssl/autorite/certificats/ca.crt \\\n  -CAkey ~/tpssl/autorite/keys/private_ca.key \\\n  -CAcreateserial \\\n  -out ~/tpssl/siteweb/certificats/siteweb.crt \\\n  -days 365 \\\n  -extfile ~/tpssl/openssl-site.cnf -extensions v3_req\n</code></pre> <p>Le certificat serveur est maintenant sign\u00e9 par la CA.</p>"},{"location":"openssl/#verification","title":"V\u00e9rification:","text":"<pre><code>openssl x509 -in ~/tpssl/siteweb/certificats/siteweb.crt -text -noout\n</code></pre>"},{"location":"openssl/#partage-des-certificats-sur-le-serveur-web","title":"Partage des certificats sur le serveur web","text":"<pre><code>scp ~/tpssl/siteweb/certificats/siteweb.crt operateur@IP_SERVEUR:/etc/ssl/monsite/\nscp ~/tpssl/siteweb/keys/siteweb.key operateur@IP_SERVEUR:/etc/ssl/monsite/\nscp ~/tpssl/autorite/certificats/ca.crt operateur@IP_SERVEUR:/etc/ssl/monsite/\n</code></pre> <p><code>IP_SERVEUR</code> : IP de la VM Apache2 ou Nginx. Ces fichiers seront utilis\u00e9s par le serveur pour s\u00e9curiser le site via TLS.</p>"},{"location":"openssl/#notes-importantes","title":"Notes importantes","text":"<p>La cl\u00e9 priv\u00e9e de la CA reste sur la VM CA.</p> <p>Tous les certificats serveurs doivent \u00eatre sign\u00e9s par cette CA pour \u00eatre reconnus comme valides par le reverse proxy ou les clients internes.</p> <p>Cette m\u00e9thode \u00e9vite les certificats auto-sign\u00e9s c\u00f4t\u00e9 serveur, le serveur web utilise un certificat sign\u00e9 par la CA interne.</p>"},{"location":"openssl/#partie-serveur-web-apache2","title":"Partie serveur web (Apache2)","text":""},{"location":"openssl/#installation","title":"installation","text":"<pre><code>sudo a2enmod ssl\n</code></pre> <p>/etc/ssl/monsite/ \u251c\u2500\u2500 siteweb.crt       # Certificat du serveur sign\u00e9 par la CA \u251c\u2500\u2500 siteweb.key       # Cl\u00e9 priv\u00e9e du serveur \u2514\u2500\u2500 ca.crt            # Certificat de la CA</p>"},{"location":"openssl/#configuration-du-site-securise","title":"Configuration du site s\u00e9curis\u00e9","text":""},{"location":"openssl/#copier-le-fichier-de-configuration-ssl-par-defaut","title":"Copier le fichier de configuration SSL par d\u00e9faut :","text":"<pre><code>sudo cp /etc/apache2/sites-available/default-ssl.conf /etc/apache2/sites-available/monsite.conf\n</code></pre>"},{"location":"openssl/#modifier-le-fichier-etcapache2sites-availablemonsiteconf","title":"Modifier le fichier /etc/apache2/sites-available/monsite.conf :","text":"<pre><code>&lt;IfModule mod_ssl.c&gt;\n    &lt;VirtualHost *:443&gt;\n        ServerAdmin admin@monsite.local\n        ServerName www.bourges.sportludique.fr\n        DocumentRoot /var/www/html\n\n        SSLEngine on\n        SSLCertificateFile      /etc/ssl/monsite/siteweb.crt\n        SSLCertificateKeyFile   /etc/ssl/monsite/siteweb.key\n        SSLCertificateChainFile /etc/ssl/monsite/ca.crt\n\n        &lt;Directory /var/www/html&gt;\n            Options Indexes FollowSymLinks\n            AllowOverride All\n        &lt;/Directory&gt;\n\n        ErrorLog ${APACHE_LOG_DIR}/error.log\n        CustomLog ${APACHE_LOG_DIR}/access.log combined\n    &lt;/VirtualHost&gt;\n&lt;/IfModule&gt;\n</code></pre>"},{"location":"openssl/#remarques","title":"Remarques :","text":"<p><code>SSLCertificateChainFile</code> contient le certificat de la CA.</p> <p><code>ServerName</code> doit correspondre exactement au CN du certificat.</p>"},{"location":"openssl/#test-du-site-https","title":"Test du site HTTPS","text":""},{"location":"openssl/#depuis-le-serveur-ou-un-client-du-reseau-interne","title":"Depuis le serveur ou un client du r\u00e9seau interne :","text":"<pre><code>curl -vk https://www.bourges.sportludique.fr\n</code></pre>"},{"location":"outils/","title":"IPAM pour la gestion des ip : https://ipam.sio.lyceefulbert.fr","text":""},{"location":"proxmox/","title":"Proxmox","text":""},{"location":"proxmox/#installation-et-configuration-du-proxmox","title":"Installation et Configuration du proxmox","text":""},{"location":"proxmox/#parametres-essentiels-a-configurer-dans-le-bios","title":"Param\u00e8tres essentiels \u00e0 configurer dans le BIOS","text":"<ul> <li> <p>D\u00e9marrer et appuyer sur F8 pour acc\u00e9der au menu ROM du contr\u00f4leur RAID.</p> </li> <li> <p>Aller dans DELETE LOGICAL VOLUMES et supprimer les volumes existants si n\u00e9cessaire.</p> </li> <li> <p>Appuyer sur ECHAP puis choisir CREATE LOGICAL VOLUMES.</p> </li> <li> <p>S\u00e9lectionner tous les disques avec la touche ESPACE.</p> </li> <li> <p>Choisir le type de RAID souhait\u00e9 (si disponible selon le firmware/\u00e9quipement).</p> </li> <li> <p>Valider la configuration pour cr\u00e9er le volume RAID.</p> </li> </ul>"},{"location":"reverseproxy/","title":"Reverse Proxy \u2013 Nginx","text":"<p>Documentation de configuration \u2013 Projet HTTPS / Certificat CA interne</p>"},{"location":"reverseproxy/#objectif-du-reverse-proxy","title":"Objectif du reverse proxy","text":"<p>Le reverse proxy Nginx a pour r\u00f4le de :</p> <p>recevoir les connexions HTTP/HTTPS depuis Internet</p> <p>rediriger toutes les requ\u00eates HTTP vers HTTPS</p> <p>pr\u00e9senter un certificat sign\u00e9 par la CA interne</p> <p>transf\u00e9rer les requ\u00eates HTTPS vers le serveur Apache situ\u00e9 dans le LAN \u2192 https://192.168.18.90</p> <p>masquer l\u2019adresse interne du serveur Web</p> <p>appliquer des r\u00e8gles de s\u00e9curit\u00e9 (SSL, en-t\u00eates, etc.)</p>"},{"location":"reverseproxy/#architecture","title":"Architecture :","text":"<pre><code>              Internet\n                  \u2502\n                  \u25bc\n          [Reverse Proxy Nginx]\n       BRG-DEBIAN-REVERSE-PROXY\n         - IP publique NAT/PAT\n         - IP LAN interne (172.28.x.x)\n                  \u2502\n                  \u25bc\n        [Serveur Web Apache HTTPS]\n              192.168.18.90\n</code></pre>"},{"location":"reverseproxy/#certificats-utilises-sur-le-reverse-proxy","title":"Certificats utilis\u00e9s sur le reverse proxy","text":"<p>Les certificats ont \u00e9t\u00e9 copi\u00e9s depuis la VM CA vers le reverse proxy dans :</p> <pre><code>/etc/ssl/monsite/\n\u251c\u2500\u2500 siteweb.crt   \u2192 Certificat du site sign\u00e9 par la CA\n\u251c\u2500\u2500 siteweb.key   \u2192 Cl\u00e9 priv\u00e9e du site\n\u2514\u2500\u2500 ca.crt        \u2192 Certificat de l'autorit\u00e9 (CA)\n</code></pre>"},{"location":"reverseproxy/#voici-le-fichier-de-configurations-dedie-au-site-internet-de-linfrastructure","title":"Voici le fichier de configurations dedi\u00e9 au site internet de l'infrastructure :","text":"<pre><code>server {\n    listen 443 ssl;\n    listen [::]:443 ssl;\n\n    server_name www.bourges.sportludique.fr;\n\n    # Certificats SSL sign\u00e9s par la CA interne\n    ssl_certificate /etc/ssl/monsite/siteweb.crt;\n    ssl_certificate_key /etc/ssl/monsite/siteweb.key;\n    ssl_trusted_certificate /etc/ssl/monsite/ca.crt;\n\n    # S\u00e9curit\u00e9 SSL\n    ssl_protocols TLSv1.2 TLSv1.3;\n    ssl_ciphers HIGH:!aNULL:!MD5;\n    ssl_prefer_server_ciphers on;\n\n    location / {\n        # Backend Apache s\u00e9curis\u00e9\n        proxy_pass https://192.168.18.90;\n\n        proxy_set_header Host $host;\n        proxy_set_header X-Real-IP $remote_addr;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n        proxy_set_header X-Forwarded-Proto $scheme;\n\n        # Le backend utilise un certificat sign\u00e9 par ta CA \u2192 tu peux v\u00e9rifier si tu veux\n        proxy_ssl_verify off;\n        # proxy_ssl_trusted_certificate /etc/ssl/monsite/ca.crt;\n    }\n}\n</code></pre>"},{"location":"reverseproxy/#redirection-http-https","title":"Redirection HTTP \u2192 HTTPS","text":"<pre><code>server {\n    listen 80;\n    listen [::]:80;\n\n    server_name www.bourges.sportludique.fr bourges.sportludique.fr;\n\n    return 301 https://$host$request_uri;\n}\n</code></pre>"},{"location":"reverseproxy/#activation-du-site","title":"Activation du site","text":"<pre><code>sudo ln -s /etc/nginx/sites-available/Bourges /etc/nginx/sites-enabled/\nsudo rm /etc/nginx/sites-enabled/default\nsudo nginx -t\nsudo systemctl restart nginx\n</code></pre>"},{"location":"reverseproxy/#verifier-nginx","title":"V\u00e9rifier Nginx","text":"<pre><code>sudo nginx -t\nsudo systemctl status nginx\n</code></pre>"},{"location":"reverseproxy/#verifier-https-depuis-lexterieur","title":"V\u00e9rifier HTTPS depuis l\u2019ext\u00e9rieur","text":"<pre><code>curl -I https://www.bourges.sportludique.fr\n</code></pre> <p>Rappel : configuration NAT/PAT sur le routeur Ports \u00e0 transf\u00e9rer vers le reverse proxy :</p> port protocole destination interne 80 TCP reverse proxy 443 TCP reverse proxy"},{"location":"routeur/","title":"Routeur","text":""},{"location":"routeur/#reinitialisation-du-routeur-cisco-et-configuration-du-routeur-cisco","title":"Reinitialisation du routeur CISCO et Configuration du routeur CISCO","text":""},{"location":"routeur/#1-appuyer-simultanement-sur-la-touche-ctrl-pause","title":"1. Appuyer simultan\u00e9ment sur la touche CTRL + PAUSE","text":"<ul> <li>confreg 0x2142</li> <li>reset</li> </ul>"},{"location":"routeur/#2-enregistrer-la-running-config-en-ayant-fait-des-modifications-et-reset-le-routeur-rommon-mode","title":"2. Enregistrer la running-config en ayant fait des modifications et reset le routeur (ROMMON MODE)","text":"<ul> <li>hostname Routeur-bourges-fibre (exemple)</li> <li>copy running-config startup-config</li> <li>reset</li> </ul>"},{"location":"routeur/#3-de-nouveau-sur-le-mode-rommon-on-modifie-le-registre-qui-charge-la-configuration-enregistree-en-memoire","title":"3. De nouveau sur le mode ROMMON, on modifie le registre qui charge la configuration enregistr\u00e9e en m\u00e9moire","text":"<ul> <li>confreg 0x2102</li> <li>Enlever le cordon d'alimentation et le remettre dedans </li> </ul>"},{"location":"routeur/#configuration-de-base-du-routeur-cisco","title":"Configuration de base du routeur Cisco","text":""},{"location":"routeur/#4renommer-le-routeur","title":"4.Renommer le routeur","text":"<ul> <li>hostname Bourges-routeur</li> </ul>"},{"location":"routeur/#5creer-un-utilisateur-avec-privileges-admin","title":"5.Cr\u00e9er un utilisateur avec privil\u00e8ges admin","text":"<ul> <li>username user privilege 15 secret motdepasse</li> </ul>"},{"location":"routeur/#6activer-le-login-via-ssh-sur-les-lignes-vty","title":"6.Activer le login via SSH sur les lignes VTY","text":"<ul> <li>line vty 0 4</li> <li>login local</li> <li>transport input ssh</li> </ul>"},{"location":"routeur/#configuration-des-interfaces-reseau","title":"<p>Configuration des interfaces r\u00e9seau</p>","text":""},{"location":"routeur/#interface-vers-le-fournisseur-dacces","title":"Interface vers le fournisseur d'acc\u00e8s","text":"interface GigabitEthernet0/0 ip address 192.x.x.x 255.x.x.x ip nat outside"},{"location":"routeur/#interface-vers-le-reseau-local-vlans-configures","title":"Interface vers le r\u00e9seau local (VLANs configur\u00e9s)","text":"interface GigabitEthernet0/1 no ip address"},{"location":"routeur/#interface-vlan-210-ex-reseau-utilisateur","title":"Interface VLAN 210 (ex : r\u00e9seau utilisateur)","text":"interface GigabitEthernet0/1.210 encapsulation dot1Q 210 ip address 172.x.x.x 255.x.x.x ip nat inside"},{"location":"routeur/#routage-route-par-defaut-nat-pat-acl","title":"Routage (Route par d\u00e9faut, NAT-PAT, ACL)","text":""},{"location":"routeur/#route-par-defaut-vers-le-fai","title":"Route par d\u00e9faut vers le FAI","text":"<ul> <li>ip route 0.0.0.0 0.0.0.0 183.x.x.x</li> </ul>"},{"location":"routeur/#configuration-du-nat","title":"Configuration du NAT","text":""},{"location":"routeur/#acl-pour-nat-autorise-les-hotes-lan-a-sortir","title":"ACL pour NAT (autorise les h\u00f4tes LAN \u00e0 sortir)","text":"<ul> <li>access-list 1 permit 172.x.x.x 0.0.0.255</li> </ul>"},{"location":"routeur/#activer-le-nat-avec-surcharge-pat","title":"Activer le NAT avec surcharge (PAT)","text":"<ul> <li>ip nat inside source list 1 interface GigabitEthernet0/0 overload</li> </ul>"},{"location":"serveur/","title":"Serveur Virtual Machine + Solution RAID","text":""},{"location":"serveur/#resume-du-raid","title":"R\u00e9sum\u00e9 du RAID","text":"RAID Min. Disques Redondance Capacit\u00e9 utile Performance Tol\u00e9rance aux pannes RAID 0 2 \u274c Non 100% \ud83d\udd25 Excellente \u274c Aucune (perte totale) RAID 1 2 \u2705 Oui 50% \ud83d\udc4d Bonne (lecture) \u2705 1 disque RAID 5 3 \u2705 Oui (N-1)/N \ud83d\udc4d Bonne \u2705 1 disque RAID 6 4 \u2705\u2705 Oui (N-2)/N \ud83d\udc4c Correcte \u2705 2 disques RAID 10 4 (paire) \u2705 Oui 50% \ud83d\udd25 Excellente \u2705 1 disque/paire (min 2)"},{"location":"serveur/#configuration-switch-salle-serveur","title":"Configuration SWITCH-SALLE-SERVEUR","text":""},{"location":"serveur/#configuration-de-lacp-etherchannel-sur-2-ports","title":"Configuration de LACP (EtherChannel) sur 2 ports:","text":"Interface GigabitEthernet1/0/23-24 switchport mode trunk channel-group 1 mode active no shutdown interface Port-channel1 description LACP vers Switch Coeur switchport mode trunk switchport trunk allowed vlan all no shutdown"},{"location":"switch/","title":"Switch","text":"<p>hostname \"nom_de_votre_switch\"</p> <p>Ce texte est bleu</p> <p>! ------------------------------------------------- !  Cr\u00e9ation du VLAN 110 pour la gestion ! -------------------------------------------------</p> <p>vlan 110     name Management exit</p> <p>interface GigabitEthernet1/0/1     switchport mode access     switchport access vlan 110     no shutdown exit</p> <p>interface GigabitEthernet1/0/1     switchport mode trunk     switchport trunk allowed vlan all     no shutdown exit ! Donner une IP \u00e0 la SVI du VLAN 110 (interface virtuelle) interface Vlan110     ip address [IP_CISCO] [MASQUE]     no shutdown exit</p> <p>! ------------------------------------------------- !  Enregistrement de la configuration ! -------------------------------------------------</p> <p>write memory</p> <p>! ------------------------------------------------- !  Configuration d\u2019un EtherChannel en LACP (Cisco 9200L) ! -------------------------------------------------</p> <p>interface range GigabitEthernet1/0/23 - 24     channel-group 1 mode active     no shutdown exit</p> <p>interface Port-channel1     description LACP vers Routeur 1900     switchport mode trunk     switchport trunk allowed vlan all     no shutdown exit</p> <p>! ------------------------------------------------- !  Activer le routage IP sur le switch ! -------------------------------------------------</p> <p>ip routing</p> <p>! ------------------------------------------------- !  DHCP Relay (relais DHCP) sur VLAN 211 ! -------------------------------------------------</p> <p>! Cr\u00e9er la SVI pour le VLAN 211 (si non existante) interface Vlan211     ip address 192.168.211.1 255.255.255.0     ip helper-address 192.168.210.10     no shutdown exit</p> <p>! ------------------------------------------------- !  Configuration de LACP (EtherChannel) sur 2 ports ! -------------------------------------------------</p> <p>interface range GigabitEthernet1/0/23 - 24  switchport mode trunk  channel-group 1 mode active  no shutdown exit</p> <p>interface Port-channel1  description LACP vers Routeur 1900  switchport mode trunk  switchport trunk allowed vlan all  no shutdown exit</p> <p>! ------------------------------------------------- ! \ud83d\udee3\ufe0f Ajouter une route par d\u00e9faut ! -------------------------------------------------</p> <p>ip route 0.0.0.0 0.0.0.0 172.x.x.x</p> <p>! ------------------------------------------------- ! \ud83d\udd10 Comptes utilisateurs ! -------------------------------------------------</p> <p>username operateur privilege 15 secret [motdepasse]</p> <p>! ------------------------------------------------- ! \ud83d\udd10 Activer SSH et acc\u00e8s distant ! -------------------------------------------------</p> <p>ip ssh version 2</p> <p>line vty 0 4  login local  transport input ssh ! line vty 0 15  login local  transport input ssh</p>"},{"location":"unbound/","title":"Unbound","text":""},{"location":"unbound/#installation-de-unbound-sous-debian","title":"installation de Unbound sous debian","text":"<p>installer les paquet</p> <pre><code>sudo apt update\nsudo apt install unbound\n</code></pre>"},{"location":"unbound/#creez-ou-modifiez-le-fichier-de-configuration-principal","title":"Cr\u00e9ez ou modifiez le fichier de configuration principal :","text":"<pre><code>sudo nano /etc/unbound/unbound.conf.d/custom.conf\n</code></pre> <p>\u00e9ffectuer la configuration dans ce fichier </p> <pre><code>server:## installation de Unbound sous debian\n\n&lt;img width=\"1040\" height=\"549\" alt=\"image\" src=\"https://assets.techrepublic.com/uploads/2022/06/how-to-install-unbound-dns.jpeg\"/&gt;\n\ninstaller les paquet\n\n</code></pre> <p>sudo apt update sudo apt install unbound</p> <pre><code>## Cr\u00e9ez ou modifiez le fichier de configuration principal :\n\n</code></pre> <p>sudo nano /etc/unbound/unbound.conf.d/custom.conf</p> <pre><code>\u00e9ffectuer la configuration dans ce fichier \n\n</code></pre> <p>server:         verbosity: 0         use-syslog: yes</p> <pre><code>    interface: 0.0.0.0\n    port: 53\n\n    do-not-query-localhost: no\n    access-control: 127.0.0.0/8 allow\n    access-control: ::1 allow\n    access-control: 192.168.110.0/24 allow\n    access-control: 172.28.128.0/24 allow\n    access-control: 192.168.18.0/24 allow\n    access-control: 172.28.129.0/24 allow\n    access-control: 172.28.159.0/25 allow\n</code></pre> <p>forward-zone:         name: \"sportludique.fr\"         forward-addr: 121.183.90.205</p>"},{"location":"unbound/#forward-zone","title":"forward-zone:","text":"<pre><code>   # name: \"brg.bourges.sportludique.fr\"\n   # forward-addr: 172.28.128.2\n</code></pre> <p>forward-zone:         name: \"bourge.sportludique.fr\"         forward-addr: 172.28.128.70  ```</p>"},{"location":"unbound/#redemarrer-unbound-apres-avoir-modifier-la-configuration","title":"red\u00e9marrer unbound apr\u00e8s avoir modifier la configuration","text":"<pre><code>sudo systemctl restart unbound\n</code></pre>"},{"location":"unbound/#pour-verifier-le-fonctionnement-de-la-configuration-tester-une-resolution-depuis-le-serveur","title":"Pour v\u00e9rifier le fonctionnement de la configuration, tester une r\u00e9solution depuis le serveur","text":"<pre><code>dig @127.0.0.1 www.google.com\n</code></pre>"},{"location":"unbound/#puis-faire-le-test-sur-un-poste-externe","title":"Puis faire le test sur un poste externe","text":"<p>machine windows</p> <pre><code>nslookup www.google.com 192.168.x.x\n</code></pre> <pre><code>    verbosity: 0\n    use-syslog: yes\n\n    interface: 0.0.0.0\n    port: 53\n\n    do-not-query-localhost: no\n    access-control: 127.0.0.0/8 allow\n    access-control: ::1 allow\n    access-control: 192.168.110.0/24 allow\n    access-control: 172.28.128.0/24 allow\n    access-control: 192.168.18.0/24 allow\n    access-control: 172.28.129.0/24 allow\n    access-control: 172.28.159.0/25 allow\n</code></pre> <p>forward-zone:         name: \"sportludique.fr\"         forward-addr: 121.183.90.205</p>"},{"location":"unbound/#forward-zone_1","title":"forward-zone:","text":"<pre><code>   # name: \"brg.bourges.sportludique.fr\"\n   # forward-addr: 172.28.128.2\n</code></pre> <p>forward-zone:         name: \"bourges.sportludique.fr\"         forward-addr: 172.28.128.70  ```</p>"},{"location":"unbound/#redemarrer-unbound-apres-avoir-modifier-la-configuration_1","title":"red\u00e9marrer unbound apr\u00e8s avoir modifier la configuration","text":"<pre><code>sudo systemctl restart unbound\n</code></pre>"},{"location":"unbound/#pour-verifier-le-fonctionnement-de-la-configuration-tester-une-resolution-depuis-le-serveur_1","title":"Pour v\u00e9rifier le fonctionnement de la configuration, tester une r\u00e9solution depuis le serveur","text":"<pre><code>dig @127.0.0.1 www.google.com\n</code></pre>"},{"location":"unbound/#puis-faire-le-test-sur-un-poste-externe_1","title":"Puis faire le test sur un poste externe","text":"<p>machine windows</p> <pre><code>nslookup www.google.com 192.168.x.x\n</code></pre>"},{"location":"unbound/#dans-lactive-directory","title":"Dans l'active directory","text":"<p>Aller dans le gestionnaire DNS puis mettre l'ip du r\u00e9solveur en temps que redirecteur.</p>"},{"location":"%C3%A9tapes/","title":"Mise en place du routeur","text":"<p>D'abord nous avons install\u00e9 Putty afin de nous connecter sur le switch connect\u00e9 sur en DB9 sur le pc, mais cela n'a pas march\u00e9 donc nous avons t\u00e9l\u00e9charg\u00e9 screen grace \u00e0 la commande Renommer le </p>"},{"location":"%C3%A9tapes/#installer-putty-et-ses-outils","title":"Installer putty et ses outils","text":"<p>sudo apt install putty putty-tools </p>"},{"location":"%C3%A9tapes/#installer-screen-essentiel-pour-se-connecter-au-switch","title":"Installer screen (essentiel pour se connecter au switch)","text":"<p>sudo apt install screen</p>"},{"location":"%C3%A9tapes/#lancer-le-screen-du-switch-cisco-connecte-de-db9","title":"Lancer le screen du switch cisco connect\u00e9 de DB9","text":"<p>sudo screen VTTYS0</p>"},{"location":"%C3%A9tapes/#installer-ssh","title":"Installer SSH","text":"<p>hostname Bourges ip domain-name bourges.local crypto key generate rsa modulus 2048 ip ssh version 2 line vty 0 4 transport input ssh login local username operateur operateur 123456</p>"},{"location":"%C3%A9tapes/#se-connecter-en-ssh","title":"Se connecter en SSH","text":"<p>ssh nom d'utilisateur@ip_du_routeur (\u00e0 assigner plus tard)</p>"},{"location":"%C3%A9tapes/#creer-le-vlan-110-et-passer-le-port-en-mode-access-et-lassigner-a-ce-vlan-qui-sera-utilise-pour-configurer-le-switch","title":"Cr\u00e9er le VLAN 110 et passer le port en mode access et l'assigner \u00e0 ce VLAN (qui sera utilis\u00e9 pour configurer le switch)","text":"<p>config vlan database vlan 110 end config int switchport mode access switchport access vlan no shut</p>"},{"location":"%C3%A9tapes/#assigner-le-nom-management-au-vlan-110","title":"Assigner le nom Management au vlan 110","text":"<p>configure terminal vlan 110 name Management</p>"},{"location":"%C3%A9tapes/#assigner-ladresse-ip-au-vlan-110","title":"Assigner l'adresse ip au VLAN 110","text":"<p>ip address ip_cisco masque </p>"},{"location":"%C3%A9tapes/#enregistrer-la-configuration","title":"Enregistrer la configuration","text":"<p>write memory</p>"}]}